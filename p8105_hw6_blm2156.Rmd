---
title: "p8105_hw6_blm2156"
author: "Britney Mazzetta"
output: github_document
---

```{r}
library(tidyverse)
```

# Problem 1
```{r}
btw = read_csv("./data/birthweight.csv") %>%
  janitor::clean_names() %>%
  mutate(
    babysex = factor(babysex, levels = c(1,2), labels = c("male", "female")),
    frace = factor(frace, levels = c(1,2,3,4,8,9), labels = c("white", "black", "asian", "puerto rican", "other", "unknown")),
    malform = factor(malform, levels = c(0,1), labels = c("absent", "present")),
    mrace = factor(mrace, levels = c(1,2,3,4,8,9), labels = c("white", "black", "asian", "puerto rican", "other", "unknown")
  ))
btw
```
## Regression Model for Birthweight

This predictors that were selected for this regression model (baby'sex, gestational age in weeks, mother's age at delivery, mother's height, parity, mother's pre-pregnancy BMI, average number of cigarettes smoked per day during pregnancy) were selected based on literatures reviews on child's birthweight.
```{r}
reg_model1 = lm(bwt ~ babysex + gaweeks + momage + mheight + parity + ppbmi + pnumlbw + smoken, data = btw)

reg_model1
```
## Plot of model residuals against fitted values
```{r}
res_plot1 = 
btw%>%
modelr::add_residuals(reg_model1) %>%
modelr::add_predictions(reg_model1) %>%
  ggplot(aes(x = pred, y = resid)) +
  geom_point()

res_plot1
  
```

